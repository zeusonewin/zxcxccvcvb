## PRIVATE SIGNAL SYSTEM — Telegram WebApp

Минимальный WebApp для Telegram с премиальным тёмным интерфейсом:

- **Выбор языка** при первом запуске (RU/EN, сохраняется в `localStorage`).
- **Onboarding-слайдер** из двух экранов со свайпом влево.
- **Главное меню** с персональным 6‑значным ID и кнопкой «CryptoPay».
- **Экран оплаты**: выбор криптовалюты и сети, переход в `@xrocket` с готовым payload.

### Структура

- `index.html` — разметка и подключение Telegram WebApp SDK.
- `styles.css` — тёмный премиальный UI, анимации, свайп-хинт, карточки.
- `app.js` — навигация между экранами, логика слайдера, генерация ID, выбор валюты/сети, создание инвойса через API.
- `api_server.py` — HTTP API сервер для создания инвойсов через xRocket API.
- `package.json` — простой `start`‑скрипт для локального запуска.

### Локальный запуск (для проверки в браузере)

```bash
cd "c:\Users\mad71\Desktop\приват систем1"
npm install
npm run start
```

После этого откройте в браузере адрес, который покажет `http-server` (по умолчанию `http://localhost:5173`).

> В Telegram WebApp может работать любой статический хостинг (Vercel, Netlify, GitHub Pages и т.п.) — просто задеплойте содержимое папки и укажите URL в настройках бота.

### Интеграция с Telegram-ботом

1. **Разместите WebApp** на публичном HTTPS‑домене (например, Vercel, Netlify, GitHub Pages).
2. **Настройте API сервер**:
   - API сервер запускается автоматически вместе с ботом на порту 8080 (по умолчанию).
   - Если API на другом домене/порту, добавьте в `.env`:
     ```
     API_URL=https://your-api-domain.com
     ```
   - Если API на том же домене, что и WebApp, можно оставить пустым — WebApp будет использовать относительный путь.
3. **Добавьте URL WebApp в `.env` файл**:
   ```
   WEBAPP_URL=https://your-domain.com/index.html
   ```
   ⚠️ **Важно**: URL должен быть HTTPS (обязательно для Telegram WebApp).
4. **Если API на другом домене**, обновите `index.html`:
   ```html
   <html lang="ru" data-api-url="https://your-api-domain.com">
   ```
5. **Перезапустите бота** — кнопка «Получить доступ» автоматически станет WebApp-кнопкой.
6. Если `WEBAPP_URL` не задан, бот будет использовать старый обработчик (создание инвойсов через callback).

> **Примечание**: Кнопка «Получить доступ» теперь открывает WebApp вместо старого меню с выбором валют. При нажатии «Оплатить» WebApp отправляет запрос на API сервер бота, который создаёт инвойс через xRocket API и возвращает ссылку на оплату.

### Как работает оплата

1. Пользователь выбирает криптовалюту и сеть в WebApp.
2. При нажатии «Оплатить» WebApp отправляет POST запрос на `/api/create-invoice` с данными пользователя (user_id из Telegram WebApp API).
3. API сервер создаёт инвойс через xRocket API и возвращает ссылку на оплату.
4. WebApp открывает ссылку на оплату в @xrocket через `Telegram.WebApp.openTelegramLink()`.

